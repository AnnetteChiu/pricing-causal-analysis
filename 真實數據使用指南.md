# çœŸå¯¦æ•¸æ“šä½¿ç”¨æŒ‡å—

## ğŸ¯ æ¦‚è¿°

æœ¬æŒ‡å—å°‡å¹«åŠ©ä½ ä½¿ç”¨è‡ªå·±çš„çœŸå¯¦æ•¸æ“šé€²è¡Œå®šåƒ¹ç­–ç•¥å› æœæ¨è«–åˆ†æã€‚æˆ‘å€‘æä¾›äº†å®Œæ•´çš„æ•¸æ“šè™•ç†æµç¨‹ï¼Œå¾åŸå§‹æ•¸æ“šåˆ°æœ€çµ‚åˆ†æçµæœã€‚

## ğŸ“Š æ”¯æŒçš„æ•¸æ“šæ ¼å¼

### æ–‡ä»¶æ ¼å¼
- **CSVæ–‡ä»¶** (.csv) - æ¨è–¦ï¼Œæ”¯æŒå¤šç¨®ç·¨ç¢¼
- **Excelæ–‡ä»¶** (.xlsx, .xls) - æ”¯æŒå¤šå€‹å·¥ä½œè¡¨

### æ•¸æ“šçµæ§‹è¦æ±‚

#### å¿…éœ€å­—æ®µ
| å­—æ®µé¡å‹ | èªªæ˜ | ç¤ºä¾‹åˆ—å |
|---------|------|----------|
| åƒ¹æ ¼ | å•†å“/æœå‹™çš„åƒ¹æ ¼ | `price`, `åƒ¹æ ¼`, `éŠ·å”®åƒ¹æ ¼`, `å–®åƒ¹` |
| éŠ·é‡ | éŠ·å”®æ•¸é‡æˆ–äº¤æ˜“é‡ | `sales_volume`, `éŠ·é‡`, `æ•¸é‡`, `äº¤æ˜“é‡` |

#### å¯é¸å­—æ®µï¼ˆå»ºè­°åŒ…å«ï¼‰
| å­—æ®µé¡å‹ | èªªæ˜ | ç¤ºä¾‹åˆ—å |
|---------|------|----------|
| æ—¥æœŸ | äº¤æ˜“æˆ–è¨˜éŒ„æ—¥æœŸ | `date`, `æ—¥æœŸ`, `äº¤æ˜“æ—¥æœŸ`, `è¨‚å–®æ—¥æœŸ` |
| å®¢æˆ¶ID | å®¢æˆ¶æ¨™è­˜ | `customer_id`, `å®¢æˆ¶ID`, `ç”¨æˆ¶ID` |
| ç”¢å“ID | ç”¢å“æ¨™è­˜ | `product_id`, `ç”¢å“ID`, `å•†å“ID` |
| åœ°å€ | åœ°ç†ä½ç½® | `region`, `åœ°å€`, `åŸå¸‚` |
| æ¸ é“ | éŠ·å”®æ¸ é“ | `channel`, `æ¸ é“`, `éŠ·å”®æ¸ é“` |

## ğŸš€ å¿«é€Ÿé–‹å§‹

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ç¤ºä¾‹æ•¸æ“š
```python
from real_data_analysis import demo_with_sample_data

# é‹è¡Œç¤ºä¾‹åˆ†æ
analyzer, data = demo_with_sample_data()
```

### æ–¹æ³•äºŒï¼šä½¿ç”¨ä½ çš„CSVæ•¸æ“š
```python
from real_data_analysis import analyze_real_data

# å®šç¾©åˆ—åæ˜ å°„
column_mapping = {
    'ä½ çš„åƒ¹æ ¼åˆ—å': 'price',
    'ä½ çš„éŠ·é‡åˆ—å': 'sales_volume',
    'ä½ çš„æ—¥æœŸåˆ—å': 'date',  # å¯é¸
    'ä½ çš„å®¢æˆ¶IDåˆ—å': 'customer_id',  # å¯é¸
}

# åŸ·è¡Œåˆ†æ
analyzer, data = analyze_real_data('your_data.csv', column_mapping)
```

### æ–¹æ³•ä¸‰ï¼šä½¿ç”¨Excelæ•¸æ“š
```python
from real_data_analysis import analyze_real_data

# Excelæ–‡ä»¶åˆ†æ
analyzer, data = analyze_real_data('your_data.xlsx', column_mapping)
```

## ğŸ“‹ è©³ç´°ä½¿ç”¨æ­¥é©Ÿ

### ç¬¬ä¸€æ­¥ï¼šæº–å‚™æ•¸æ“š

#### 1.1 æª¢æŸ¥æ•¸æ“šè³ªé‡
```python
import pandas as pd

# åŠ è¼‰æ•¸æ“š
data = pd.read_csv('your_data.csv')

# æª¢æŸ¥åŸºæœ¬ä¿¡æ¯
print("æ•¸æ“šå½¢ç‹€:", data.shape)
print("åˆ—å:", data.columns.tolist())
print("ç¼ºå¤±å€¼:", data.isnull().sum())
print("æ•¸æ“šé¡å‹:", data.dtypes)
```

#### 1.2 æ•¸æ“šæ¸…ç†å»ºè­°
- ç§»é™¤æ˜é¡¯çš„ç•°å¸¸å€¼ï¼ˆå¦‚è² åƒ¹æ ¼ï¼‰
- è™•ç†ç¼ºå¤±å€¼
- ç¢ºä¿æ—¥æœŸæ ¼å¼æ­£ç¢º
- çµ±ä¸€åˆ†é¡è®Šæ•¸çš„å‘½å

### ç¬¬äºŒæ­¥ï¼šä½¿ç”¨æ•¸æ“šåŠ è¼‰å™¨

```python
from real_data_loader import RealDataLoader

# å‰µå»ºåŠ è¼‰å™¨
loader = RealDataLoader()

# åŠ è¼‰æ•¸æ“š
data = loader.load_csv_data('your_data.csv')

# ç²å–åˆ—åå»ºè­°
suggestions = loader.suggest_column_mapping()
print("å»ºè­°çš„åˆ—åæ˜ å°„:", suggestions)
```

### ç¬¬ä¸‰æ­¥ï¼šæ•¸æ“šé è™•ç†

```python
# æ˜ å°„åˆ—å
column_mapping = {
    'original_price_column': 'price',
    'original_volume_column': 'sales_volume',
    # æ·»åŠ å…¶ä»–æ˜ å°„...
}
mapped_data = loader.map_columns(column_mapping)

# æ•¸æ“šé è™•ç†
processed_data = loader.preprocess_data(
    price_col='price',
    volume_col='sales_volume',
    date_col='date',  # å¦‚æœæœ‰æ—¥æœŸåˆ—
    remove_outliers=True,
    outlier_method='iqr'  # æˆ– 'zscore'
)
```

### ç¬¬å››æ­¥ï¼šå‰µå»ºè™•ç†è®Šæ•¸

```python
# æ–¹æ³•1: åŸºæ–¼åƒ¹æ ¼ä¸­ä½æ•¸åˆ†çµ„
final_data = loader.create_treatment_variable(method='median_split')

# æ–¹æ³•2: åŸºæ–¼ç‰¹å®šåƒ¹æ ¼é–¾å€¼
final_data = loader.create_treatment_variable(
    method='price_change', 
    threshold=100  # ä½ çš„åƒ¹æ ¼é–¾å€¼
)

# æ–¹æ³•3: åŸºæ–¼æ™‚é–“åˆ†çµ„ï¼ˆå¦‚æœæœ‰æ˜ç¢ºçš„åƒ¹æ ¼è®Šå‹•æ™‚é–“é»ï¼‰
final_data = loader.create_treatment_variable(
    method='date_based',
    date_col='date',
    treatment_date='2023-06-01'  # åƒ¹æ ¼ç­–ç•¥è®Šå‹•æ—¥æœŸ
)
```

### ç¬¬äº”æ­¥ï¼šåŸ·è¡Œå› æœæ¨è«–åˆ†æ

```python
from pricing_causal_analysis import PricingCausalAnalysis

# å‰µå»ºåˆ†æå™¨
analyzer = PricingCausalAnalysis(data=final_data)

# åŸ·è¡Œå„ç¨®åˆ†æ
analyzer.randomized_experiment_analysis()
analyzer.regression_adjustment_analysis()
analyzer.propensity_score_analysis()
analyzer.price_elasticity_analysis()

# ç”Ÿæˆå ±å‘Š
analyzer.generate_report()
```

## ğŸ“Š å¯¦éš›æ¡ˆä¾‹

### æ¡ˆä¾‹1ï¼šé›»å•†å¹³å°æ•¸æ“š

å‡è¨­ä½ æœ‰ä»¥ä¸‹æ ¼å¼çš„é›»å•†æ•¸æ“šï¼š

```csv
è¨‚å–®æ—¥æœŸ,å•†å“ID,å®¢æˆ¶ID,éŠ·å”®åƒ¹æ ¼,è³¼è²·æ•¸é‡,ä¿ƒéŠ·é¡å‹,åœ°å€
2023-01-01,P001,C001,99.9,2,ç„¡,åŒ—äº¬
2023-01-01,P002,C002,149.9,1,æŠ˜æ‰£,ä¸Šæµ·
...
```

ä½¿ç”¨ä»£ç¢¼ï¼š
```python
column_mapping = {
    'éŠ·å”®åƒ¹æ ¼': 'price',
    'è³¼è²·æ•¸é‡': 'sales_volume',
    'è¨‚å–®æ—¥æœŸ': 'date',
    'å®¢æˆ¶ID': 'customer_id',
    'å•†å“ID': 'product_id'
}

analyzer, data = analyze_real_data('ecommerce_data.csv', column_mapping)
```

### æ¡ˆä¾‹2ï¼šSaaSè¨‚é–±æ•¸æ“š

```csv
è¨‚é–±æ—¥æœŸ,ç”¨æˆ¶ID,å¥—é¤åƒ¹æ ¼,è¨‚é–±æœˆæ•¸,ç”¨æˆ¶é¡å‹,ä¾†æºæ¸ é“
2023-01-01,U001,299,12,ä¼æ¥­,ç›´éŠ·
2023-01-02,U002,99,1,å€‹äºº,ç¶²ç«™
...
```

ä½¿ç”¨ä»£ç¢¼ï¼š
```python
column_mapping = {
    'å¥—é¤åƒ¹æ ¼': 'price',
    'è¨‚é–±æœˆæ•¸': 'sales_volume',
    'è¨‚é–±æ—¥æœŸ': 'date',
    'ç”¨æˆ¶ID': 'customer_id'
}

analyzer, data = analyze_real_data('saas_data.csv', column_mapping)
```

## âš ï¸ å¸¸è¦‹å•é¡Œå’Œè§£æ±ºæ–¹æ¡ˆ

### Q1: æ•¸æ“šä¸­æ²’æœ‰æ˜ç¢ºçš„å¯¦é©—çµ„/å°ç…§çµ„æ€éº¼è¾¦ï¼Ÿ

**A**: ç³»çµ±æœƒè‡ªå‹•å‰µå»ºè™•ç†è®Šæ•¸ï¼š
- åŸºæ–¼åƒ¹æ ¼ä¸­ä½æ•¸åˆ†çµ„ï¼ˆæ¨è–¦ï¼‰
- åŸºæ–¼ç‰¹å®šæ™‚é–“é»åˆ†çµ„
- åŸºæ–¼åƒ¹æ ¼é–¾å€¼åˆ†çµ„

### Q2: æ•¸æ“šé‡å¾ˆå¤§ï¼Œè™•ç†é€Ÿåº¦æ…¢æ€éº¼è¾¦ï¼Ÿ

**A**: 
```python
# ä½¿ç”¨æ•¸æ“šæŠ½æ¨£
sample_data = data.sample(n=10000, random_state=42)

# æˆ–è€…åˆ†æ‰¹è™•ç†
for chunk in pd.read_csv('large_file.csv', chunksize=5000):
    # è™•ç†æ¯å€‹chunk
    pass
```

### Q3: çµæœä¸é¡¯è‘—æ€éº¼è¾¦ï¼Ÿ

**A**: å¯èƒ½çš„åŸå› å’Œè§£æ±ºæ–¹æ¡ˆï¼š
- **æ¨£æœ¬é‡ä¸è¶³**: æ”¶é›†æ›´å¤šæ•¸æ“š
- **è™•ç†æ•ˆæ‡‰å¤ªå°**: æª¢æŸ¥æ¥­å‹™é‚è¼¯ï¼Œå¯èƒ½éœ€è¦æ›´å¤§çš„åƒ¹æ ¼è®Šå‹•
- **æ··æ·†è®Šæ•¸**: æ·»åŠ æ›´å¤šæ§åˆ¶è®Šæ•¸
- **æ•¸æ“šè³ªé‡å•é¡Œ**: æª¢æŸ¥ç•°å¸¸å€¼å’Œç¼ºå¤±å€¼

### Q4: å¦‚ä½•è§£é‡‹è² çš„è™•ç†æ•ˆæ‡‰ï¼Ÿ

**A**: 
- å¦‚æœå¯¦é©—çµ„æ˜¯ä½åƒ¹çµ„ï¼Œè² æ•ˆæ‡‰æ„å‘³è‘—é™åƒ¹æ²’æœ‰å¢åŠ éŠ·é‡
- æª¢æŸ¥æ˜¯å¦æœ‰å…¶ä»–å› ç´ å½±éŸ¿ï¼ˆå¦‚åº«å­˜ã€ç«¶çˆ­ç­‰ï¼‰
- è€ƒæ…®éç·šæ€§é—œä¿‚æˆ–é–¾å€¼æ•ˆæ‡‰

## ğŸ”§ é«˜ç´šåŠŸèƒ½

### è‡ªå®šç¾©æ§åˆ¶è®Šæ•¸
```python
# æ·»åŠ è‡ªå®šç¾©æ§åˆ¶è®Šæ•¸
enhanced_data = loader.add_control_variables(
    date_col='date',
    customer_col='customer_id',
    product_col='product_id'
)

# æ‰‹å‹•æ·»åŠ æ¥­å‹™ç›¸é—œè®Šæ•¸
enhanced_data['is_weekend'] = enhanced_data['date'].dt.weekday >= 5
enhanced_data['is_holiday'] = enhanced_data['date'].isin(holiday_dates)
```

### ç•°è³ªæ€§åˆ†æ
```python
# æŒ‰ä¸åŒç¾¤é«”åˆ†æè™•ç†æ•ˆæ‡‰
for segment in data['customer_segment'].unique():
    segment_data = data[data['customer_segment'] == segment]
    segment_analyzer = PricingCausalAnalysis(data=segment_data)
    segment_analyzer.randomized_experiment_analysis()
    print(f"{segment}ç¾¤é«”çš„è™•ç†æ•ˆæ‡‰: {segment_analyzer.results['experiment_analysis']['ate_sales']}")
```

### æ•æ„Ÿæ€§åˆ†æ
```python
# æ¸¬è©¦ä¸åŒçš„ç•°å¸¸å€¼è™•ç†æ–¹æ³•
for method in ['iqr', 'zscore']:
    processed_data = loader.preprocess_data(
        price_col='price',
        volume_col='sales_volume',
        remove_outliers=True,
        outlier_method=method
    )
    # æ¯”è¼ƒçµæœ...
```

## ğŸ“ˆ çµæœè§£è®€æŒ‡å—

### çµ±è¨ˆé¡¯è‘—æ€§
- **p < 0.01**: é«˜åº¦é¡¯è‘—ï¼Œçµæœéå¸¸å¯ä¿¡
- **0.01 â‰¤ p < 0.05**: é¡¯è‘—ï¼Œçµæœå¯ä¿¡
- **0.05 â‰¤ p < 0.1**: é‚Šéš›é¡¯è‘—ï¼Œéœ€è¬¹æ…è§£é‡‹
- **p â‰¥ 0.1**: ä¸é¡¯è‘—ï¼Œå¯èƒ½æ²’æœ‰çœŸå¯¦æ•ˆæ‡‰

### æ•ˆæ‡‰å¤§å°
- è€ƒæ…®æ¥­å‹™æ„ç¾©ï¼Œä¸åƒ…åƒ…æ˜¯çµ±è¨ˆé¡¯è‘—æ€§
- è¨ˆç®—æ•ˆæ‡‰çš„ç¶“æ¿Ÿåƒ¹å€¼
- èˆ‡è¡Œæ¥­åŸºæº–æ¯”è¼ƒ

### ç½®ä¿¡å€é–“
- å¯¬ç½®ä¿¡å€é–“è¡¨ç¤ºä¸ç¢ºå®šæ€§è¼ƒå¤§
- çª„ç½®ä¿¡å€é–“è¡¨ç¤ºä¼°è¨ˆè¼ƒç²¾ç¢º

## ğŸ’¡ æœ€ä½³å¯¦è¸

1. **æ•¸æ“šè³ªé‡ç¬¬ä¸€**: ç¢ºä¿æ•¸æ“šæº–ç¢ºã€å®Œæ•´
2. **æ¥­å‹™ç†è§£**: çµåˆæ¥­å‹™èƒŒæ™¯è§£é‡‹çµæœ
3. **å¤šæ–¹æ³•é©—è­‰**: ä½¿ç”¨å¤šç¨®å› æœæ¨è«–æ–¹æ³•äº¤å‰é©—è­‰
4. **æŒçºŒç›£æ§**: å»ºç«‹å®šæœŸåˆ†ææ©Ÿåˆ¶
5. **æ–‡æª”è¨˜éŒ„**: è¨˜éŒ„åˆ†æéç¨‹å’Œå‡è¨­

## ğŸ†˜ ç²å–å¹«åŠ©

å¦‚æœé‡åˆ°å•é¡Œï¼š
1. æª¢æŸ¥æ•¸æ“šæ ¼å¼æ˜¯å¦ç¬¦åˆè¦æ±‚
2. æŸ¥çœ‹éŒ¯èª¤ä¿¡æ¯å’Œæ—¥èªŒ
3. åƒè€ƒç¤ºä¾‹ä»£ç¢¼
4. åœ¨GitHubä¸Šæäº¤Issue

---

**è¨˜ä½**: å› æœæ¨è«–éœ€è¦è¬¹æ…çš„å‡è¨­å’Œè§£é‡‹ã€‚çµæœåƒ…ä¾›åƒè€ƒï¼Œé‡è¦æ±ºç­–è«‹çµåˆæ¥­å‹™å°ˆå®¶æ„è¦‹ã€‚